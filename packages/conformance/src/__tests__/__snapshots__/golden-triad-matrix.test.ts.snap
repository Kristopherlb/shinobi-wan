// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`Golden: Triad Matrix (G-040, G-041) > 'admin-wildcard' × 'Baseline' > determinism: identical input produces byte-identical output 1`] = `"{"snapshot":{"schemaVersion":"1.0.0","nodes":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:a22492024a7fe7cc33759e87ac653c31a00895fb8f0116a06a997b0783fdbd2b","id":"component:admin-svc","type":"component"},{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:e4b67d7f868c896628bbfe8df2930f30891f92b2f9ef96193a62d0b3f38b921c","id":"platform:aws-sqs","type":"platform"}],"edges":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"bindingConfig":{"resourceType":"queue","accessLevel":"admin","network":{"port":443,"protocol":"any"}}},"semanticHash":"sha256:2200d6c023b9e4a3c806b13dd5ffc79d01789ee7bfa83a9a7d4df9f289ea50d3","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs","type":"bindsTo","source":"component:admin-svc","target":"platform:aws-sqs"}],"artifacts":[]},"intents":[{"type":"iam","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:admin-svc:platform:aws-sqs","principal":{"nodeRef":"component:admin-svc","role":"component"},"resource":{"nodeRef":"platform:aws-sqs","resourceType":"queue","scope":"specific"},"actions":[{"level":"read","action":"read"},{"level":"write","action":"write"},{"level":"admin","action":"admin"}]},{"type":"network","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:admin-svc:platform:aws-sqs","direction":"egress","source":{"nodeRef":"component:admin-svc","port":443},"destination":{"nodeRef":"platform:aws-sqs","port":443},"protocol":{"protocol":"any","ports":[443]}}],"bindingDiagnostics":[],"policy":{"violations":[{"id":"violation:iam-admin-access-review:edge:bindsTo:component:admin-svc:platform:aws-sqs","schemaVersion":"1.0.0","ruleId":"iam-admin-access-review","ruleName":"Admin Access Review","severity":"info","target":{"type":"edge","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs"},"message":"IAM intent on edge \\"edge:bindsTo:component:admin-svc:platform:aws-sqs\\" grants admin-level access. Admin grants full control.","remediation":{"summary":"Consider 'read' or 'write' access level. Admin grants full control","autoFixable":false},"policyPack":"Baseline"},{"id":"violation:iam-missing-conditions:edge:bindsTo:component:admin-svc:platform:aws-sqs","schemaVersion":"1.0.0","ruleId":"iam-missing-conditions","ruleName":"Missing IAM Conditions","severity":"info","target":{"type":"edge","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs"},"message":"IAM intent on edge \\"edge:bindsTo:component:admin-svc:platform:aws-sqs\\" grants cross-service access (component:admin-svc → platform:aws-sqs) without conditions.","remediation":{"summary":"Add conditions to scope cross-service access","autoFixable":false},"policyPack":"Baseline"},{"id":"violation:network-broad-protocol:edge:bindsTo:component:admin-svc:platform:aws-sqs","schemaVersion":"1.0.0","ruleId":"network-broad-protocol","ruleName":"Broad Network Protocol","severity":"info","target":{"type":"edge","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs"},"message":"Network intent on edge \\"edge:bindsTo:component:admin-svc:platform:aws-sqs\\" uses protocol \\"any\\". Specify \\"tcp\\" or \\"udp\\" instead.","remediation":{"summary":"Specify protocol as 'tcp' or 'udp' instead of 'any'","autoFixable":false},"policyPack":"Baseline"}],"compliant":true,"policyPack":"Baseline"},"validation":{"valid":true,"errors":[],"schemaVersion":"1.0.0"},"resolvedConfig":{}}"`;

exports[`Golden: Triad Matrix (G-040, G-041) > 'admin-wildcard' × 'FedRAMP-High' > determinism: identical input produces byte-identical output 1`] = `"{"snapshot":{"schemaVersion":"1.0.0","nodes":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:a22492024a7fe7cc33759e87ac653c31a00895fb8f0116a06a997b0783fdbd2b","id":"component:admin-svc","type":"component"},{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:e4b67d7f868c896628bbfe8df2930f30891f92b2f9ef96193a62d0b3f38b921c","id":"platform:aws-sqs","type":"platform"}],"edges":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"bindingConfig":{"resourceType":"queue","accessLevel":"admin","network":{"port":443,"protocol":"any"}}},"semanticHash":"sha256:2200d6c023b9e4a3c806b13dd5ffc79d01789ee7bfa83a9a7d4df9f289ea50d3","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs","type":"bindsTo","source":"component:admin-svc","target":"platform:aws-sqs"}],"artifacts":[]},"intents":[{"type":"iam","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:admin-svc:platform:aws-sqs","principal":{"nodeRef":"component:admin-svc","role":"component"},"resource":{"nodeRef":"platform:aws-sqs","resourceType":"queue","scope":"specific"},"actions":[{"level":"read","action":"read"},{"level":"write","action":"write"},{"level":"admin","action":"admin"}]},{"type":"network","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:admin-svc:platform:aws-sqs","direction":"egress","source":{"nodeRef":"component:admin-svc","port":443},"destination":{"nodeRef":"platform:aws-sqs","port":443},"protocol":{"protocol":"any","ports":[443]}}],"bindingDiagnostics":[],"policy":{"violations":[{"id":"violation:iam-admin-access-review:edge:bindsTo:component:admin-svc:platform:aws-sqs","schemaVersion":"1.0.0","ruleId":"iam-admin-access-review","ruleName":"Admin Access Review","severity":"error","target":{"type":"edge","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs"},"message":"IAM intent on edge \\"edge:bindsTo:component:admin-svc:platform:aws-sqs\\" grants admin-level access. Admin grants full control.","remediation":{"summary":"Consider 'read' or 'write' access level. Admin grants full control","autoFixable":false},"policyPack":"FedRAMP-High"},{"id":"violation:iam-missing-conditions:edge:bindsTo:component:admin-svc:platform:aws-sqs","schemaVersion":"1.0.0","ruleId":"iam-missing-conditions","ruleName":"Missing IAM Conditions","severity":"error","target":{"type":"edge","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs"},"message":"IAM intent on edge \\"edge:bindsTo:component:admin-svc:platform:aws-sqs\\" grants cross-service access (component:admin-svc → platform:aws-sqs) without conditions.","remediation":{"summary":"Add conditions to scope cross-service access","autoFixable":false},"policyPack":"FedRAMP-High"},{"id":"violation:network-broad-protocol:edge:bindsTo:component:admin-svc:platform:aws-sqs","schemaVersion":"1.0.0","ruleId":"network-broad-protocol","ruleName":"Broad Network Protocol","severity":"error","target":{"type":"edge","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs"},"message":"Network intent on edge \\"edge:bindsTo:component:admin-svc:platform:aws-sqs\\" uses protocol \\"any\\". Specify \\"tcp\\" or \\"udp\\" instead.","remediation":{"summary":"Specify protocol as 'tcp' or 'udp' instead of 'any'","autoFixable":false},"policyPack":"FedRAMP-High"}],"compliant":false,"policyPack":"FedRAMP-High"},"validation":{"valid":true,"errors":[],"schemaVersion":"1.0.0"},"resolvedConfig":{}}"`;

exports[`Golden: Triad Matrix (G-040, G-041) > 'admin-wildcard' × 'FedRAMP-Moderate' > determinism: identical input produces byte-identical output 1`] = `"{"snapshot":{"schemaVersion":"1.0.0","nodes":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:a22492024a7fe7cc33759e87ac653c31a00895fb8f0116a06a997b0783fdbd2b","id":"component:admin-svc","type":"component"},{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:e4b67d7f868c896628bbfe8df2930f30891f92b2f9ef96193a62d0b3f38b921c","id":"platform:aws-sqs","type":"platform"}],"edges":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"bindingConfig":{"resourceType":"queue","accessLevel":"admin","network":{"port":443,"protocol":"any"}}},"semanticHash":"sha256:2200d6c023b9e4a3c806b13dd5ffc79d01789ee7bfa83a9a7d4df9f289ea50d3","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs","type":"bindsTo","source":"component:admin-svc","target":"platform:aws-sqs"}],"artifacts":[]},"intents":[{"type":"iam","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:admin-svc:platform:aws-sqs","principal":{"nodeRef":"component:admin-svc","role":"component"},"resource":{"nodeRef":"platform:aws-sqs","resourceType":"queue","scope":"specific"},"actions":[{"level":"read","action":"read"},{"level":"write","action":"write"},{"level":"admin","action":"admin"}]},{"type":"network","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:admin-svc:platform:aws-sqs","direction":"egress","source":{"nodeRef":"component:admin-svc","port":443},"destination":{"nodeRef":"platform:aws-sqs","port":443},"protocol":{"protocol":"any","ports":[443]}}],"bindingDiagnostics":[],"policy":{"violations":[{"id":"violation:iam-admin-access-review:edge:bindsTo:component:admin-svc:platform:aws-sqs","schemaVersion":"1.0.0","ruleId":"iam-admin-access-review","ruleName":"Admin Access Review","severity":"warning","target":{"type":"edge","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs"},"message":"IAM intent on edge \\"edge:bindsTo:component:admin-svc:platform:aws-sqs\\" grants admin-level access. Admin grants full control.","remediation":{"summary":"Consider 'read' or 'write' access level. Admin grants full control","autoFixable":false},"policyPack":"FedRAMP-Moderate"},{"id":"violation:iam-missing-conditions:edge:bindsTo:component:admin-svc:platform:aws-sqs","schemaVersion":"1.0.0","ruleId":"iam-missing-conditions","ruleName":"Missing IAM Conditions","severity":"warning","target":{"type":"edge","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs"},"message":"IAM intent on edge \\"edge:bindsTo:component:admin-svc:platform:aws-sqs\\" grants cross-service access (component:admin-svc → platform:aws-sqs) without conditions.","remediation":{"summary":"Add conditions to scope cross-service access","autoFixable":false},"policyPack":"FedRAMP-Moderate"},{"id":"violation:network-broad-protocol:edge:bindsTo:component:admin-svc:platform:aws-sqs","schemaVersion":"1.0.0","ruleId":"network-broad-protocol","ruleName":"Broad Network Protocol","severity":"warning","target":{"type":"edge","id":"edge:bindsTo:component:admin-svc:platform:aws-sqs"},"message":"Network intent on edge \\"edge:bindsTo:component:admin-svc:platform:aws-sqs\\" uses protocol \\"any\\". Specify \\"tcp\\" or \\"udp\\" instead.","remediation":{"summary":"Specify protocol as 'tcp' or 'udp' instead of 'any'","autoFixable":false},"policyPack":"FedRAMP-Moderate"}],"compliant":true,"policyPack":"FedRAMP-Moderate"},"validation":{"valid":true,"errors":[],"schemaVersion":"1.0.0"},"resolvedConfig":{}}"`;

exports[`Golden: Triad Matrix (G-040, G-041) > 'clean-read' × 'Baseline' > determinism: identical input produces byte-identical output 1`] = `"{"snapshot":{"schemaVersion":"1.0.0","nodes":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:ccb86bb8671a7f1fad098ab2a3164bd51b70442fff0f252341f740c5deab02d8","id":"component:clean-svc","type":"component"},{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:fb776b7596593e3428f6cb5f098e82d2ab54dc7416e4343746d90ca76e137a01","id":"platform:clean-db","type":"platform"}],"edges":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"bindingConfig":{"resourceType":"table","accessLevel":"read","network":{"port":5432,"protocol":"tcp"}}},"semanticHash":"sha256:220db2e335be6d0dd0831e48aa7aaea4fe79601190a881bdab9b26ef5fe60fc8","id":"edge:bindsTo:component:clean-svc:platform:clean-db","type":"bindsTo","source":"component:clean-svc","target":"platform:clean-db"}],"artifacts":[]},"intents":[{"type":"iam","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:clean-svc:platform:clean-db","principal":{"nodeRef":"component:clean-svc","role":"component"},"resource":{"nodeRef":"platform:clean-db","resourceType":"table","scope":"specific"},"actions":[{"level":"read","action":"read"}]},{"type":"network","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:clean-svc:platform:clean-db","direction":"egress","source":{"nodeRef":"component:clean-svc","port":5432},"destination":{"nodeRef":"platform:clean-db","port":5432},"protocol":{"protocol":"tcp","ports":[5432]}}],"bindingDiagnostics":[],"policy":{"violations":[{"id":"violation:iam-missing-conditions:edge:bindsTo:component:clean-svc:platform:clean-db","schemaVersion":"1.0.0","ruleId":"iam-missing-conditions","ruleName":"Missing IAM Conditions","severity":"info","target":{"type":"edge","id":"edge:bindsTo:component:clean-svc:platform:clean-db"},"message":"IAM intent on edge \\"edge:bindsTo:component:clean-svc:platform:clean-db\\" grants cross-service access (component:clean-svc → platform:clean-db) without conditions.","remediation":{"summary":"Add conditions to scope cross-service access","autoFixable":false},"policyPack":"Baseline"}],"compliant":true,"policyPack":"Baseline"},"validation":{"valid":true,"errors":[],"schemaVersion":"1.0.0"},"resolvedConfig":{}}"`;

exports[`Golden: Triad Matrix (G-040, G-041) > 'clean-read' × 'FedRAMP-High' > determinism: identical input produces byte-identical output 1`] = `"{"snapshot":{"schemaVersion":"1.0.0","nodes":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:ccb86bb8671a7f1fad098ab2a3164bd51b70442fff0f252341f740c5deab02d8","id":"component:clean-svc","type":"component"},{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:fb776b7596593e3428f6cb5f098e82d2ab54dc7416e4343746d90ca76e137a01","id":"platform:clean-db","type":"platform"}],"edges":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"bindingConfig":{"resourceType":"table","accessLevel":"read","network":{"port":5432,"protocol":"tcp"}}},"semanticHash":"sha256:220db2e335be6d0dd0831e48aa7aaea4fe79601190a881bdab9b26ef5fe60fc8","id":"edge:bindsTo:component:clean-svc:platform:clean-db","type":"bindsTo","source":"component:clean-svc","target":"platform:clean-db"}],"artifacts":[]},"intents":[{"type":"iam","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:clean-svc:platform:clean-db","principal":{"nodeRef":"component:clean-svc","role":"component"},"resource":{"nodeRef":"platform:clean-db","resourceType":"table","scope":"specific"},"actions":[{"level":"read","action":"read"}]},{"type":"network","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:clean-svc:platform:clean-db","direction":"egress","source":{"nodeRef":"component:clean-svc","port":5432},"destination":{"nodeRef":"platform:clean-db","port":5432},"protocol":{"protocol":"tcp","ports":[5432]}}],"bindingDiagnostics":[],"policy":{"violations":[{"id":"violation:iam-missing-conditions:edge:bindsTo:component:clean-svc:platform:clean-db","schemaVersion":"1.0.0","ruleId":"iam-missing-conditions","ruleName":"Missing IAM Conditions","severity":"error","target":{"type":"edge","id":"edge:bindsTo:component:clean-svc:platform:clean-db"},"message":"IAM intent on edge \\"edge:bindsTo:component:clean-svc:platform:clean-db\\" grants cross-service access (component:clean-svc → platform:clean-db) without conditions.","remediation":{"summary":"Add conditions to scope cross-service access","autoFixable":false},"policyPack":"FedRAMP-High"}],"compliant":false,"policyPack":"FedRAMP-High"},"validation":{"valid":true,"errors":[],"schemaVersion":"1.0.0"},"resolvedConfig":{}}"`;

exports[`Golden: Triad Matrix (G-040, G-041) > 'clean-read' × 'FedRAMP-Moderate' > determinism: identical input produces byte-identical output 1`] = `"{"snapshot":{"schemaVersion":"1.0.0","nodes":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:ccb86bb8671a7f1fad098ab2a3164bd51b70442fff0f252341f740c5deab02d8","id":"component:clean-svc","type":"component"},{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:fb776b7596593e3428f6cb5f098e82d2ab54dc7416e4343746d90ca76e137a01","id":"platform:clean-db","type":"platform"}],"edges":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"bindingConfig":{"resourceType":"table","accessLevel":"read","network":{"port":5432,"protocol":"tcp"}}},"semanticHash":"sha256:220db2e335be6d0dd0831e48aa7aaea4fe79601190a881bdab9b26ef5fe60fc8","id":"edge:bindsTo:component:clean-svc:platform:clean-db","type":"bindsTo","source":"component:clean-svc","target":"platform:clean-db"}],"artifacts":[]},"intents":[{"type":"iam","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:clean-svc:platform:clean-db","principal":{"nodeRef":"component:clean-svc","role":"component"},"resource":{"nodeRef":"platform:clean-db","resourceType":"table","scope":"specific"},"actions":[{"level":"read","action":"read"}]},{"type":"network","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:clean-svc:platform:clean-db","direction":"egress","source":{"nodeRef":"component:clean-svc","port":5432},"destination":{"nodeRef":"platform:clean-db","port":5432},"protocol":{"protocol":"tcp","ports":[5432]}}],"bindingDiagnostics":[],"policy":{"violations":[{"id":"violation:iam-missing-conditions:edge:bindsTo:component:clean-svc:platform:clean-db","schemaVersion":"1.0.0","ruleId":"iam-missing-conditions","ruleName":"Missing IAM Conditions","severity":"warning","target":{"type":"edge","id":"edge:bindsTo:component:clean-svc:platform:clean-db"},"message":"IAM intent on edge \\"edge:bindsTo:component:clean-svc:platform:clean-db\\" grants cross-service access (component:clean-svc → platform:clean-db) without conditions.","remediation":{"summary":"Add conditions to scope cross-service access","autoFixable":false},"policyPack":"FedRAMP-Moderate"}],"compliant":true,"policyPack":"FedRAMP-Moderate"},"validation":{"valid":true,"errors":[],"schemaVersion":"1.0.0"},"resolvedConfig":{}}"`;

exports[`Golden: Triad Matrix (G-040, G-041) > 'wildcard-resource' × 'Baseline' > determinism: identical input produces byte-identical output 1`] = `"{"snapshot":{"schemaVersion":"1.0.0","nodes":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:0bf67b77a545bdf518cb81d44941a923a70ffa6a40379ab0a4fb8c5c6c0f9df4","id":"component:wildcard-svc","type":"component"},{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:3736e5ef2a12c70fb7c38ec5d22eabd52785973e2aebb3cbec4306dc84d6cee3","id":"platform:wildcard-db","type":"platform"}],"edges":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"bindingConfig":{"resourceType":"table","accessLevel":"read","scope":"pattern","network":{"port":5432,"protocol":"tcp"}}},"semanticHash":"sha256:acc0395781b0d45c78170b7116bc5a20e2ce1b57556cc098628e83235729260d","id":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db","type":"bindsTo","source":"component:wildcard-svc","target":"platform:wildcard-db"}],"artifacts":[]},"intents":[{"type":"iam","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db","principal":{"nodeRef":"component:wildcard-svc","role":"component"},"resource":{"nodeRef":"platform:wildcard-db","resourceType":"table","scope":"pattern"},"actions":[{"level":"read","action":"read"}]},{"type":"network","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db","direction":"egress","source":{"nodeRef":"component:wildcard-svc","port":5432},"destination":{"nodeRef":"platform:wildcard-db","port":5432},"protocol":{"protocol":"tcp","ports":[5432]}}],"bindingDiagnostics":[],"policy":{"violations":[{"id":"violation:iam-no-wildcard-resource:edge:bindsTo:component:wildcard-svc:platform:wildcard-db","schemaVersion":"1.0.0","ruleId":"iam-no-wildcard-resource","ruleName":"No Wildcard Resources","severity":"warning","target":{"type":"edge","id":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db"},"message":"IAM intent on edge \\"edge:bindsTo:component:wildcard-svc:platform:wildcard-db\\" uses pattern-scoped resource \\"*\\". Wildcard scopes violate least privilege.","remediation":{"summary":"Use scope 'specific' with explicit resource references","autoFixable":false},"policyPack":"Baseline"},{"id":"violation:iam-missing-conditions:edge:bindsTo:component:wildcard-svc:platform:wildcard-db","schemaVersion":"1.0.0","ruleId":"iam-missing-conditions","ruleName":"Missing IAM Conditions","severity":"info","target":{"type":"edge","id":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db"},"message":"IAM intent on edge \\"edge:bindsTo:component:wildcard-svc:platform:wildcard-db\\" grants cross-service access (component:wildcard-svc → platform:wildcard-db) without conditions.","remediation":{"summary":"Add conditions to scope cross-service access","autoFixable":false},"policyPack":"Baseline"}],"compliant":true,"policyPack":"Baseline"},"validation":{"valid":true,"errors":[],"schemaVersion":"1.0.0"},"resolvedConfig":{}}"`;

exports[`Golden: Triad Matrix (G-040, G-041) > 'wildcard-resource' × 'FedRAMP-High' > determinism: identical input produces byte-identical output 1`] = `"{"snapshot":{"schemaVersion":"1.0.0","nodes":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:0bf67b77a545bdf518cb81d44941a923a70ffa6a40379ab0a4fb8c5c6c0f9df4","id":"component:wildcard-svc","type":"component"},{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:3736e5ef2a12c70fb7c38ec5d22eabd52785973e2aebb3cbec4306dc84d6cee3","id":"platform:wildcard-db","type":"platform"}],"edges":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"bindingConfig":{"resourceType":"table","accessLevel":"read","scope":"pattern","network":{"port":5432,"protocol":"tcp"}}},"semanticHash":"sha256:acc0395781b0d45c78170b7116bc5a20e2ce1b57556cc098628e83235729260d","id":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db","type":"bindsTo","source":"component:wildcard-svc","target":"platform:wildcard-db"}],"artifacts":[]},"intents":[{"type":"iam","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db","principal":{"nodeRef":"component:wildcard-svc","role":"component"},"resource":{"nodeRef":"platform:wildcard-db","resourceType":"table","scope":"pattern"},"actions":[{"level":"read","action":"read"}]},{"type":"network","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db","direction":"egress","source":{"nodeRef":"component:wildcard-svc","port":5432},"destination":{"nodeRef":"platform:wildcard-db","port":5432},"protocol":{"protocol":"tcp","ports":[5432]}}],"bindingDiagnostics":[],"policy":{"violations":[{"id":"violation:iam-missing-conditions:edge:bindsTo:component:wildcard-svc:platform:wildcard-db","schemaVersion":"1.0.0","ruleId":"iam-missing-conditions","ruleName":"Missing IAM Conditions","severity":"error","target":{"type":"edge","id":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db"},"message":"IAM intent on edge \\"edge:bindsTo:component:wildcard-svc:platform:wildcard-db\\" grants cross-service access (component:wildcard-svc → platform:wildcard-db) without conditions.","remediation":{"summary":"Add conditions to scope cross-service access","autoFixable":false},"policyPack":"FedRAMP-High"},{"id":"violation:iam-no-wildcard-resource:edge:bindsTo:component:wildcard-svc:platform:wildcard-db","schemaVersion":"1.0.0","ruleId":"iam-no-wildcard-resource","ruleName":"No Wildcard Resources","severity":"error","target":{"type":"edge","id":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db"},"message":"IAM intent on edge \\"edge:bindsTo:component:wildcard-svc:platform:wildcard-db\\" uses pattern-scoped resource \\"*\\". Wildcard scopes violate least privilege.","remediation":{"summary":"Use scope 'specific' with explicit resource references","autoFixable":false},"policyPack":"FedRAMP-High"}],"compliant":false,"policyPack":"FedRAMP-High"},"validation":{"valid":true,"errors":[],"schemaVersion":"1.0.0"},"resolvedConfig":{}}"`;

exports[`Golden: Triad Matrix (G-040, G-041) > 'wildcard-resource' × 'FedRAMP-Moderate' > determinism: identical input produces byte-identical output 1`] = `"{"snapshot":{"schemaVersion":"1.0.0","nodes":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:0bf67b77a545bdf518cb81d44941a923a70ffa6a40379ab0a4fb8c5c6c0f9df4","id":"component:wildcard-svc","type":"component"},{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"properties":{}},"semanticHash":"sha256:3736e5ef2a12c70fb7c38ec5d22eabd52785973e2aebb3cbec4306dc84d6cee3","id":"platform:wildcard-db","type":"platform"}],"edges":[{"schemaVersion":"1.0.0","provenance":{"sourceFile":"test.ts"},"metadata":{"bindingConfig":{"resourceType":"table","accessLevel":"read","scope":"pattern","network":{"port":5432,"protocol":"tcp"}}},"semanticHash":"sha256:acc0395781b0d45c78170b7116bc5a20e2ce1b57556cc098628e83235729260d","id":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db","type":"bindsTo","source":"component:wildcard-svc","target":"platform:wildcard-db"}],"artifacts":[]},"intents":[{"type":"iam","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db","principal":{"nodeRef":"component:wildcard-svc","role":"component"},"resource":{"nodeRef":"platform:wildcard-db","resourceType":"table","scope":"pattern"},"actions":[{"level":"read","action":"read"}]},{"type":"network","schemaVersion":"1.0.0","sourceEdgeId":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db","direction":"egress","source":{"nodeRef":"component:wildcard-svc","port":5432},"destination":{"nodeRef":"platform:wildcard-db","port":5432},"protocol":{"protocol":"tcp","ports":[5432]}}],"bindingDiagnostics":[],"policy":{"violations":[{"id":"violation:iam-no-wildcard-resource:edge:bindsTo:component:wildcard-svc:platform:wildcard-db","schemaVersion":"1.0.0","ruleId":"iam-no-wildcard-resource","ruleName":"No Wildcard Resources","severity":"error","target":{"type":"edge","id":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db"},"message":"IAM intent on edge \\"edge:bindsTo:component:wildcard-svc:platform:wildcard-db\\" uses pattern-scoped resource \\"*\\". Wildcard scopes violate least privilege.","remediation":{"summary":"Use scope 'specific' with explicit resource references","autoFixable":false},"policyPack":"FedRAMP-Moderate"},{"id":"violation:iam-missing-conditions:edge:bindsTo:component:wildcard-svc:platform:wildcard-db","schemaVersion":"1.0.0","ruleId":"iam-missing-conditions","ruleName":"Missing IAM Conditions","severity":"warning","target":{"type":"edge","id":"edge:bindsTo:component:wildcard-svc:platform:wildcard-db"},"message":"IAM intent on edge \\"edge:bindsTo:component:wildcard-svc:platform:wildcard-db\\" grants cross-service access (component:wildcard-svc → platform:wildcard-db) without conditions.","remediation":{"summary":"Add conditions to scope cross-service access","autoFixable":false},"policyPack":"FedRAMP-Moderate"}],"compliant":false,"policyPack":"FedRAMP-Moderate"},"validation":{"valid":true,"errors":[],"schemaVersion":"1.0.0"},"resolvedConfig":{}}"`;
